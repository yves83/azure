# Redirect Windows Forwared Event to SecurityEvent Table in Log Aanalytic Workspace

Background
Windows Event Forwarder collect the remote Windows Event logs and saved in Forwared Event table. Sentinel collect the Forwared Event logs with Windows Forwared Event data connector.
However, the Windows Events are saved in WindowsEvent table of Log Analytic Workspace. To redirect the Windows Security log to SecurityEvent table, we must use DCR transform rule to 
migrate the data from WindowsEvent to SecurityEvent. The most challenging configuration is mapping the fields in WindowsEvent to SecurityEvent. Below is the dataFlows configuration.
Copy the following configuration and replace the DCR configuration in the template.

Partial Data Collection Rule Configuration
=============================================
```
"dataFlows": [
    {
        "streams": [
            "Microsoft-WindowsEvent"
        ],
        "destinations": [
            "DataCollectionEvent"
        ],
        "transformKql": "source | where Channel != 'Security'",
        "outputStream": "Microsoft-WindowsEvent"
    },					
    {
        "streams": [
            "Microsoft-WindowsEvent"
        ],
        "destinations": [
            "DataCollectionEvent"
        ],
        "transformKql": "source | where Channel == 'Security' | extend e=parse_json(EventData) | extend TimeCollected=todatetime(e.TimeCollected), SourceComputerId=toguid(e.SourceComputerId), MG=toguid(e.MG), InterfaceUuid=toguid(e.InterfaceUuid), LogonGuid=toguid(e.LogonGuid), SubcategoryGuid=toguid(e.SubcategoryGuid), TargetLogonGuid=toguid(e.TargetLogonGuid), Task=toint(e.Task), EventID=toint(e.EventID), AuditsDiscarded=toint(e.AuditsDiscarded), AuthenticationLevel=toint(e.AuthenticationLevel), AuthenticationService=toint(e.AuthenticationService), ErrorCode=toint(e.ErrorCode), KeyLength=toint(e.KeyLength), LogonType=toint(e.LogonType), ServiceStartType=toint(e.ServiceStartType), SourceSystem=tostring(e.SourceSystem), Account=tostring(e.Account), AccountType=tostring(e.AccountType), Computer=tostring(e.Computer), EventSourceName=tostring(e.EventSourceName), Channel=tostring(e.Channel), Level=tostring(e.Level), EventData=tostring(e.EventData), Activity=tostring(e.Activity), EventOriginId=tostring(e.EventOriginId), ManagementGroupName=tostring(e.ManagementGroupName), PartitionKey=tostring(e.PartitionKey), RowKey=tostring(e.RowKey), StorageAccount=tostring(e.StorageAccount), AzureDeploymentID=tostring(e.AzureDeploymentID), AzureTableName=tostring(e.AzureTableName), AccessList=tostring(e.AccessList), AccessMask=tostring(e.AccessMask), AccessReason=tostring(e.AccessReason), AccountDomain=tostring(e.AccountDomain), AccountExpires=tostring(e.AccountExpires), AccountName=tostring(e.AccountName), AccountSessionIdentifier=tostring(e.AccountSessionIdentifier), AdditionalInfo=tostring(e.AdditionalInfo), AdditionalInfo2=tostring(e.AdditionalInfo2), AllowedToDelegateTo=tostring(e.AllowedToDelegateTo), Attributes=tostring(e.Attributes), AuditPolicyChanges=tostring(e.AuditPolicyChanges), AuthenticationPackageName=tostring(e.AuthenticationPackageName), AuthenticationProvider=tostring(e.AuthenticationProvider), AuthenticationServer=tostring(e.AuthenticationServer), AuthenticationType=tostring(e.AuthenticationType), CACertificateHash=tostring(e.CACertificateHash), CalledStationID=tostring(e.CalledStationID), CallerProcessId=tostring(e.CallerProcessId), CallerProcessName=tostring(e.CallerProcessName), CallingStationID=tostring(e.CallingStationID), CAPublicKeyHash=tostring(e.CAPublicKeyHash), CategoryId=tostring(e.CategoryId), CertificateDatabaseHash=tostring(e.CertificateDatabaseHash), ClassId=tostring(e.ClassId), ClassName=tostring(e.ClassName), ClientAddress=tostring(e.ClientAddress), ClientIPAddress=tostring(e.ClientIPAddress), ClientName=tostring(e.ClientName), CommandLine=tostring(e.CommandLine), CompatibleIds=tostring(e.CompatibleIds), DCDNSName=tostring(e.DCDNSName), DeviceDescription=tostring(e.DeviceDescription), DeviceId=tostring(e.DeviceId), DisplayName=tostring(e.DisplayName), Disposition=tostring(e.Disposition), DomainBehaviorVersion=tostring(e.DomainBehaviorVersion), DomainName=tostring(e.DomainName), DomainPolicyChanged=tostring(e.DomainPolicyChanged), DomainSid=tostring(e.DomainSid), EAPType=tostring(e.EAPType), ElevatedToken=tostring(e.ElevatedToken), ExtendedQuarantineState=tostring(e.ExtendedQuarantineState), FailureReason=tostring(e.FailureReason), FileHash=tostring(e.FileHash), FilePath=tostring(e.FilePath), FilePathNoUser=tostring(e.FilePathNoUser), Filter=tostring(e.Filter), ForceLogoff=tostring(e.ForceLogoff), Fqbn=tostring(e.Fqbn), FullyQualifiedSubjectMachineName=tostring(e.FullyQualifiedSubjectMachineName), FullyQualifiedSubjectUserName=tostring(e.FullyQualifiedSubjectUserName), GroupMembership=tostring(e.GroupMembership), HandleId=tostring(e.HandleId), HardwareIds=tostring(e.HardwareIds), HomeDirectory=tostring(e.HomeDirectory), HomePath=tostring(e.HomePath), ImpersonationLevel=tostring(e.ImpersonationLevel), IpAddress=tostring(e.IpAddress), IpPort=tostring(e.IpPort), LmPackageName=tostring(e.LmPackageName), LocationInformation=tostring(e.LocationInformation), LockoutDuration=tostring(e.LockoutDuration), LockoutObservationWindow=tostring(e.LockoutObservationWindow), LockoutThreshold=tostring(e.LockoutThreshold), LoggingResult=tostring(e.LoggingResult), LogonHours=tostring(e.LogonHours), LogonID=tostring(e.LogonID), LogonProcessName=tostring(e.LogonProcessName), LogonTypeName=tostring(e.LogonTypeName), MachineAccountQuota=tostring(e.MachineAccountQuota), MachineInventory=tostring(e.MachineInventory), MachineLogon=tostring(e.MachineLogon), MandatoryLabel=tostring(e.MandatoryLabel), MaxPasswordAge=tostring(e.MaxPasswordAge), MemberName=tostring(e.MemberName), MemberSid=tostring(e.MemberSid), MinPasswordAge=tostring(e.MinPasswordAge), MinPasswordLength=tostring(e.MinPasswordLength), MixedDomainMode=tostring(e.MixedDomainMode), NASIdentifier=tostring(e.NASIdentifier), NASIPv4Address=tostring(e.NASIPv4Address), NASIPv6Address=tostring(e.NASIPv6Address), NASPort=tostring(e.NASPort), NASPortType=tostring(e.NASPortType), NetworkPolicyName=tostring(e.NetworkPolicyName), NewDate=tostring(e.NewDate), NewMaxUsers=tostring(e.NewMaxUsers), NewProcessId=tostring(e.NewProcessId), NewProcessName=tostring(e.NewProcessName), NewRemark=tostring(e.NewRemark), NewShareFlags=tostring(e.NewShareFlags), NewTime=tostring(e.NewTime), NewUacValue=tostring(e.NewUacValue), NewValue=tostring(e.NewValue), NewValueType=tostring(e.NewValueType), ObjectName=tostring(e.ObjectName), ObjectServer=tostring(e.ObjectServer), ObjectType=tostring(e.ObjectType), ObjectValueName=tostring(e.ObjectValueName), OemInformation=tostring(e.OemInformation), OldMaxUsers=tostring(e.OldMaxUsers), OldRemark=tostring(e.OldRemark), OldShareFlags=tostring(e.OldShareFlags), OldUacValue=tostring(e.OldUacValue), OldValue=tostring(e.OldValue), OldValueType=tostring(e.OldValueType), OperationType=tostring(e.OperationType), PackageName=tostring(e.PackageName), ParentProcessName=tostring(e.ParentProcessName), PasswordHistoryLength=tostring(e.PasswordHistoryLength), PasswordLastSet=tostring(e.PasswordLastSet), PasswordProperties=tostring(e.PasswordProperties), PreviousDate=tostring(e.PreviousDate), PreviousTime=tostring(e.PreviousTime), PrimaryGroupId=tostring(e.PrimaryGroupId), PrivateKeyUsageCount=tostring(e.PrivateKeyUsageCount), PrivilegeList=tostring(e.PrivilegeList), Process=tostring(e.Process), ProcessId=tostring(e.ProcessId), ProcessName=tostring(e.ProcessName), Properties=tostring(e.Properties), ProfilePath=tostring(e.ProfilePath), ProtocolSequence=tostring(e.ProtocolSequence), ProxyPolicyName=tostring(e.ProxyPolicyName), QuarantineHelpURL=tostring(e.QuarantineHelpURL), QuarantineSessionID=tostring(e.QuarantineSessionID), QuarantineSessionIdentifier=tostring(e.QuarantineSessionIdentifier), QuarantineState=tostring(e.QuarantineState), QuarantineSystemHealthResult=tostring(e.QuarantineSystemHealthResult), RelativeTargetName=tostring(e.RelativeTargetName), RemoteIpAddress=tostring(e.RemoteIpAddress), RemotePort=tostring(e.RemotePort), Requester=tostring(e.Requester), RequestId=tostring(e.RequestId), RestrictedAdminMode=tostring(e.RestrictedAdminMode), RowsDeleted=tostring(e.RowsDeleted), SamAccountName=tostring(e.SamAccountName), ScriptPath=tostring(e.ScriptPath), SecurityDescriptor=tostring(e.SecurityDescriptor), ServiceAccount=tostring(e.ServiceAccount), ServiceFileName=tostring(e.ServiceFileName), ServiceName=tostring(e.ServiceName), ServiceType=tostring(e.ServiceType), SessionName=tostring(e.SessionName), ShareLocalPath=tostring(e.ShareLocalPath), ShareName=tostring(e.ShareName), SidHistory=tostring(e.SidHistory), Status=tostring(e.Status), SubjectAccount=tostring(e.SubjectAccount), SubcategoryId=tostring(e.SubcategoryId), Subject=tostring(e.Subject), SubjectDomainName=tostring(e.SubjectDomainName), SubjectKeyIdentifier=tostring(e.SubjectKeyIdentifier), SubjectLogonId=tostring(e.SubjectLogonId), SubjectMachineName=tostring(e.SubjectMachineName), SubjectMachineSID=tostring(e.SubjectMachineSID), SubjectUserName=tostring(e.SubjectUserName), SubjectUserSid=tostring(e.SubjectUserSid), SubStatus=tostring(e.SubStatus), TableId=tostring(e.TableId), TargetAccount=tostring(e.TargetAccount), TargetDomainName=tostring(e.TargetDomainName), TargetInfo=tostring(e.TargetInfo), TargetLinkedLogonId=tostring(e.TargetLinkedLogonId), TargetLogonId=tostring(e.TargetLogonId), TargetOutboundDomainName=tostring(e.TargetOutboundDomainName), TargetOutboundUserName=tostring(e.TargetOutboundUserName), TargetServerName=tostring(e.TargetServerName), TargetSid=tostring(e.TargetSid), TargetUser=tostring(e.TargetUser), TargetUserName=tostring(e.TargetUserName), TargetUserSid=tostring(e.TargetUserSid), TemplateContent=tostring(e.TemplateContent), TemplateDSObjectFQDN=tostring(e.TemplateDSObjectFQDN), TemplateInternalName=tostring(e.TemplateInternalName), TemplateOID=tostring(e.TemplateOID), TemplateSchemaVersion=tostring(e.TemplateSchemaVersion), TemplateVersion=tostring(e.TemplateVersion), TokenElevationType=tostring(e.TokenElevationType), TransmittedServices=tostring(e.TransmittedServices), UserAccountControl=tostring(e.UserAccountControl), UserParameters=tostring(e.UserParameters), UserPrincipalName=tostring(e.UserPrincipalName), UserWorkstations=tostring(e.UserWorkstations), VirtualAccount=tostring(e.VirtualAccount), VendorIds=tostring(e.VendorIds), Workstation=tostring(e.Workstation), WorkstationName=tostring(e.WorkstationName) | project TenantId, TimeGenerated, TimeCollected, SourceComputerId, MG, InterfaceUuid, LogonGuid, SubcategoryGuid, TargetLogonGuid, Task, EventID, AuditsDiscarded, AuthenticationLevel, AuthenticationService, ErrorCode, KeyLength, LogonType, ServiceStartType, SourceSystem, Account, AccountType, Computer, EventSourceName, Channel, Level, EventData, Activity, EventOriginId, ManagementGroupName, PartitionKey, RowKey, StorageAccount, AzureDeploymentID, AzureTableName, AccessList, AccessMask, AccessReason, AccountDomain, AccountExpires, AccountName, AccountSessionIdentifier, AdditionalInfo, AdditionalInfo2, AllowedToDelegateTo, Attributes, AuditPolicyChanges, AuthenticationPackageName, AuthenticationProvider, AuthenticationServer, AuthenticationType, CACertificateHash, CalledStationID, CallerProcessId, CallerProcessName, CallingStationID, CAPublicKeyHash, CategoryId, CertificateDatabaseHash, ClassId, ClassName, ClientAddress, ClientIPAddress, ClientName, CommandLine, CompatibleIds, DCDNSName, DeviceDescription, DeviceId, DisplayName, Disposition, DomainBehaviorVersion, DomainName, DomainPolicyChanged, DomainSid, EAPType, ElevatedToken, ExtendedQuarantineState, FailureReason, FileHash, FilePath, FilePathNoUser, Filter, ForceLogoff, Fqbn, FullyQualifiedSubjectMachineName, FullyQualifiedSubjectUserName, GroupMembership, HandleId, HardwareIds, HomeDirectory, HomePath, ImpersonationLevel, IpAddress, IpPort, LmPackageName, LocationInformation, LockoutDuration, LockoutObservationWindow, LockoutThreshold, LoggingResult, LogonHours, LogonID, LogonProcessName, LogonTypeName, MachineAccountQuota, MachineInventory, MachineLogon, MandatoryLabel, MaxPasswordAge, MemberName, MemberSid, MinPasswordAge, MinPasswordLength, MixedDomainMode, NASIdentifier, NASIPv4Address, NASIPv6Address, NASPort, NASPortType, NetworkPolicyName, NewDate, NewMaxUsers, NewProcessId, NewProcessName, NewRemark, NewShareFlags, NewTime, NewUacValue, NewValue, NewValueType, ObjectName, ObjectServer, ObjectType, ObjectValueName, OemInformation, OldMaxUsers, OldRemark, OldShareFlags, OldUacValue, OldValue, OldValueType, OperationType, PackageName, ParentProcessName, PasswordHistoryLength, PasswordLastSet, PasswordProperties, PreviousDate, PreviousTime, PrimaryGroupId, PrivateKeyUsageCount, PrivilegeList, Process, ProcessId, ProcessName, Properties, ProfilePath, ProtocolSequence, ProxyPolicyName, QuarantineHelpURL, QuarantineSessionID, QuarantineSessionIdentifier, QuarantineState, QuarantineSystemHealthResult, RelativeTargetName, RemoteIpAddress, RemotePort, Requester, RequestId, RestrictedAdminMode, RowsDeleted, SamAccountName, ScriptPath, SecurityDescriptor, ServiceAccount, ServiceFileName, ServiceName, ServiceType, SessionName, ShareLocalPath, ShareName, SidHistory, Status, SubjectAccount, SubcategoryId, Subject, SubjectDomainName, SubjectKeyIdentifier, SubjectLogonId, SubjectMachineName, SubjectMachineSID, SubjectUserName, SubjectUserSid, SubStatus, TableId, TargetAccount, TargetDomainName, TargetInfo, TargetLinkedLogonId, TargetLogonId, TargetOutboundDomainName, TargetOutboundUserName, TargetServerName, TargetSid, TargetUser, TargetUserName, TargetUserSid, TemplateContent, TemplateDSObjectFQDN, TemplateInternalName, TemplateOID, TemplateSchemaVersion, TemplateVersion, TokenElevationType, TransmittedServices, UserAccountControl, UserParameters, UserPrincipalName, UserWorkstations, VirtualAccount, VendorIds, Workstation, WorkstationName",
        "outputStream": "Microsoft-SecurityEvent"
    }
]
```
